---
title: Деформируемая модель (.dfm)
---

## Обзор

Деформируемые (персонажные) модели.

| Имя      | Тип    | Описание                                                                                             |
| --------- | ------- | ------------------------------------------------------------------------------------------------------- |
| Fractions | float[] | Доли LOD из диапазона, определенного в INI-файлах, количество плавающих индексов, сколько ожидается записей Mesh*. |

## Группы поверностей

| Имя             | Тип     | Описание                                           |
| ---------------- | -------- | ----------------------------------------------------- |
| Material_name    | string   | Название материала, который будет использоваться для этой группы граней сетки. |
| Tristrip_indices | uint16[] | Индексы вершин треугольников полосы.                    |
| Face_indices     | uint16[] | Индексы вершин массива треугольников.                    |

* `Material_name` должен указывать на материал, расположенный в библиотеке материалов в том же файле.
* Группа граней может использовать либо `Tristrip_indices` для треугольной полосы, либо `Face_indices` для простого массива треугольников.

## Геометрия

| Имя              | Тип     | Описание                                          |
| ----------------- | -------- | ---------------------------------------------------- |
| Point_indices     | uint32[] | Индексы элементов для точек координат вершин.        |
| UV0_indices       | uint32[] | Индексы элементов для точек координат UV0.           |
| UV1_indices       | uint32[] | Индексы элементов для координатных точек UV1.           |
| Points            | float[]  | float[3] для каждой вершины.                                 |
| Point_bone_first  | uint32[] | Начальный индекс в цепочках костей для вершины.               |
| Point_bone_count  | uint32[] | Количество костей, влияющих на вершину.                    |
| Bone_id_chain     | uint32[] | Массив костных индексов (максимум 4), влияющих на вершину.      |
| Bone_weight_chain | float[]  | Массив весов костей (максимум 4), влияющих на вершину.      |
| Vertex_normals    | float[]  | float[3] для каждой вершины.                                 |
| UV0               | float[]  | float[2] на каждую координату.                             |
| UV1               | float[]  | float[2] на каждую координату.                             |
| Min_du            | float    | Минимальное U-дельта.                                     |
| Max_du            | float    | Максимальное U-дельта.                                     |
| Min_dv            | float    | Минимальное V delta-дельта.                                     |
| Max_dv            | float    | Максимальное V-дельта.                                     |
| Bone_X_to_U_scale | float    | Масштаб переноса положения кости X на карту 1 U.       |
| Bone_Y_to_V_scale | float    | Масштабы перемещения кости Y в положение на карте 1 V.       |
| UV_vertex_count   | uint32   | Количество UV-координат.                                 |
| UV_bone_id        | uint32[] | Кость, которая влияет на выбранные вершины UV.             |
| UV_vertex_id      | uint32[] | Вершины, на которые влияет кость с UV_bone_id.             |
| UV_default_list   | float    | Стандартные UV-координаты для вершин в UV_vertex_id? |
| UV_plane_distance | float    | По умолчанию 1?                                           |

* Индексы костей на вершину:  

```cs
for (i = Point_bone_first[v], l = i + Point_bone_count[v]; i < l; i++) 
{
    Bone_id_chain[i]
}
```

* Веса костей для каждой вершины: 

```cs
for (i = Point_bone_first[v], l = i + Point_bone_count[v]; i < l; i++)                 
{
    Bone_weight_chain[i]
}
```
